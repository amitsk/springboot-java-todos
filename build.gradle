plugins {
    id 'org.springframework.boot' version '2.2.0.M1'
    id 'java'
}

apply plugin: 'io.spring.dependency-management'


ext {
    restAssuredVersion = '3.2.0'
    jacksonVersion = '2.9.7'
    junitJupiterVersion = '5.3.2'
    resilience4jVersion = '0.13.2'
    retrofitVersion = '2.5.0'
    retrofitInterceptorVersion = '2.4.0'
    reactorAdapterVersion = '2.1.0'
    backstopperVersion = '0.11.5'
    assertJVersion = '3.11.1'
    mockitoVersion = '2.23.0'
    mockWebServerVersion = '3.10.0'
}

group = 'com.github.amitsk'
version = '0.0.1-SNAPSHOT'
sourceCompatibility = 1.8

configurations {
    compileOnly {
        extendsFrom annotationProcessor
    }
}

repositories {
    mavenCentral()
    maven { url 'https://repo.spring.io/snapshot' }
    maven { url 'https://repo.spring.io/milestone' }
}

ext {
    set('springCloudVersion', 'Greenwich.BUILD-SNAPSHOT')
}

dependencies {
    implementation 'org.springframework.boot:spring-boot-starter-actuator'
    implementation 'org.springframework.boot:spring-boot-starter-webflux'
    implementation 'org.springframework.cloud:spring-cloud-starter-sleuth'
    compileOnly 'org.projectlombok:lombok'
    runtimeOnly 'org.springframework.boot:spring-boot-devtools'
    annotationProcessor 'org.projectlombok:lombok'
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
    testImplementation 'io.projectreactor:reactor-test'
    compile ('io.projectreactor.addons:reactor-extra')
    
    compile "com.nike.backstopper:backstopper-core:$backstopperVersion"
    compile "com.squareup.retrofit2:retrofit:$retrofitVersion"
    compile "com.squareup.retrofit2:converter-jackson:$retrofitVersion"
    compile "io.github.resilience4j:resilience4j-circuitbreaker:$resilience4jVersion"
    compile "io.github.resilience4j:resilience4j-cache:$resilience4jVersion"
    compile "io.github.resilience4j:resilience4j-reactor:$resilience4jVersion"
    compile "com.jakewharton.retrofit:retrofit2-reactor-adapter:$reactorAdapterVersion"

    
    // JUnit Jupiter API and TestEngine implementation
    testCompile("org.junit.jupiter:junit-jupiter-api:${junitJupiterVersion}")
    testCompile("org.junit.jupiter:junit-jupiter-params:${junitJupiterVersion}")
    testCompile ("io.rest-assured:rest-assured:${restAssuredVersion}")
    testCompile "org.assertj:assertj-core:$assertJVersion"
    testCompile "org.mockito:mockito-core:$mockitoVersion"
    testCompile "com.squareup.okhttp3:mockwebserver:$mockWebServerVersion"

    testImplementation "org.junit.jupiter:junit-jupiter-api:${junitJupiterVersion}"
    testRuntimeOnly "org.junit.jupiter:junit-jupiter-engine:${junitJupiterVersion}"
    // To avoid compiler warnings about @API annotations in JUnit code
    testCompileOnly('org.apiguardian:apiguardian-api:1.0.0')
}

dependencyManagement {
    imports {
        mavenBom "org.springframework.cloud:spring-cloud-dependencies:${springCloudVersion}"
    }
}

test {
    testLogging {
        showStandardStreams = true
    }
    useJUnitPlatform {
        // includeTags 'fast'
        excludeTags 'slow'

        // includeEngines 'junit-jupiter', 'junit-vintage'
        // excludeEngines 'custom-engine'
    }
}

